name: bump-container
description: Dereference a container registry pointer tag such as as latest
author: Simon Li
inputs:
  repo:
    required: true
    description: 'Repository, either `docker.io/<owner>/<repo>` or `quay.io/<owner>/<repo>`'
  pointerTag:
    required: true
    description: Tag to be dereferenced
    default: latest
  regex:
    required: false
    description: Optional regular expression to match against the tag
    default: ''
  maxTagsToFetch:
    required: false
    description: Maximum number of tags to fetch, default is the first page returned by the registry API (currently 10 for Docker Hub, 50 for quay.io)
    default: ''
  updateFile:
    required: false
    description: Path to file to be updated with the new tag
  pattern:
    required: false
    description: |
      Regular expression to match against the content of updateFile, can include groups.
      For example '(repository: openmicroscopy\\/omero-web-standalone\\n\\s+tag:) (\\S+)'
  replace:
    required: false
    description: |
      String to replace the matched pattern with, `${tag}` will be replaced with the new tag.
      For example '$1 ${tag}' where '$1' will be replaced with the first group in pattern

runs:
  using: 'node16'
  main: 'dist/index.js'
